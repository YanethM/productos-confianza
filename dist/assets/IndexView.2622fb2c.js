import{b as M,F as T,E as C,d as D,o as F,c as B,a as x,g as w,i as I,n as N,p as P,f as L}from"./moment.90abcc35.js";import{c as f,a as b,b as a}from"./object.ec3bc54f.js";import{_ as U,B as K,r as p,o as n,c as d,a as o,w as _,F as h,b as r,t as m,e as y,I as E,J as S,K as k,p as G,g as R,L as Z,d as H}from"./index.3e1e514d.js";import{T as O}from"./TimerView.d0e8420d.js";const J={components:{BaseLoading:K,Field:M,Form:T,ErrorMessage:C,TimerView:O},data(){return{data:{name:"",last_name:"",departamento:"",provincia:"",distrito:"",agency:"",amountRequested:""},offices:[],loading:!1,departamentos:D,provincias_select:[],distritos_select:[]}},beforeCreate(){this.$store.state.token.token||this.$router.push({name:"Home",params:{product:this.$route.params.product}})},methods:{onlyLetters:F,onlyNumbers:B,findOffices(){this.data.agency="",this.loading=!0,this.offices=[];let i={params:{country:"604",department:`${this.data.departamento}`,province:`${this.data.provincia}`,district:`${this.data.distrito}`},headers:{"x-address":this.$store.state.token.xAddress,"x-api-key":this.$store.state.token.xApiKey,token:this.$store.state.token.token,"token-bt":this.$store.state.token.tokenBT}};x.get("/landing-agency",i).then(t=>{t.data.code==="0"?this.offices=t.data.agencies:(this.$store.dispatch("message/SET_MESSAGE",t.data.message),this.$router.push({name:"Message",params:{product:this.$route.params.product}}))}).catch(()=>{this.$store.dispatch("message/SET_MESSAGE","Se ha generado un error al procesar la solicitud. Intente nuevamente en unos minutos."),this.$router.push({name:"Message",params:{product:this.$route.params.product}})}).finally(()=>{this.loading=!1})},saveData(){this.loading=!0;let i={token:`${this.$store.state.token.token}`,tokenBT:`${this.$store.state.token.tokenBT}`,names:w(this.data.name),lastNames:w(this.data.last_name),ubigeoDepartment:`${this.data.departamento}`,ubigeoProvince:`${this.data.provincia}`,ubigeoDistrict:`${this.data.distrito}`,agency:`${this.data.agency}`,mode:"2"};this.$route.params.product==="dpf"&&(i.amountRequested=`${this.data.amountRequested}`);let t={"x-address":this.$store.state.token.xAddress,"x-api-key":this.$store.state.token.xApiKey,"X-MAC":this.$route.params.product==="dpf"?I(i):N(i)};x.put("/landing-registration",i,{headers:t}).then(v=>{v.data.code==="0"?(this.$store.dispatch("message/SET_MESSAGE",v.data.message),this.$router.push({name:"Message",params:{product:this.$route.params.product}})):(this.$store.dispatch("message/SET_MESSAGE",v.data.message),this.$router.push({name:"Message",params:{product:this.$route.params.product}}))}).catch(()=>{this.$store.dispatch("message/SET_MESSAGE","Se ha generado un error al procesar la solicitud. Intente nuevamente en unos minutos."),this.$router.push({name:"Message",params:{product:this.$route.params.product}})}).finally(()=>{this.loading=!1})},getDepartamento(){this.data.provincia="",this.data.distrito="",this.data.agency="",this.provincias_select=[],this.distritos_select=[],this.provincias_select=P.filter(i=>i.departamento_id===this.data.departamento)},getProvincia(){this.data.distrito="",this.data.agency="",this.distritos_select=[],this.distritos_select=L.filter(i=>i.provincia_id===this.data.provincia)}},computed:{clientName(){return this.$store.state.token.existeBT==="S"?this.$store.state.user.name:this.$store.state.user.document_num},isClient(){return this.$store.state.token.existeBT==="S"},isDPF(){return this.$route.params.product==="dpf"},schema(){return this.isClient&&this.isDPF?f({amount:b().required("El campo es requerido").min(100,"El monto debe ser mayor o igual a S/ 100").typeError("Ingrese el monto"),departamento:a().required("El campo es requerido"),provincia:a().required("El campo es requerido"),distrito:a().required("El campo es requerido"),agency:a().required("Seleccione una oficina")}):this.isClient?f({departamento:a().required("El campo es requerido"),provincia:a().required("El campo es requerido"),distrito:a().required("El campo es requerido"),agency:a().required("Seleccione una oficina")}):!this.isClient&&this.isDPF?f({name:a().required("El campo es requerido").matches(/[a-zA-Z ]{2,254}/,"El campo solo puede contener letras",{excludeEmptyString:!0}),last_name:a().required("El campo es requerido").matches(/[a-zA-Z ]{2,254}/,"El campo solo puede contener letras",{excludeEmptyString:!0}),amount:b().required("El campo es requerido").min(100,"El monto debe ser mayor o igual a S/ 100").typeError("Ingrese el monto"),departamento:a().required("El campo es requerido"),provincia:a().required("El campo es requerido"),distrito:a().required("El campo es requerido"),agency:a().required("Seleccione una oficina")}):f({name:a().required("El campo es requerido").matches(/[a-zA-Z ]{2,254}/,"El campo solo puede contener letras",{excludeEmptyString:!0}),last_name:a().required("El campo es requerido").matches(/[a-zA-Z ]{2,254}/,"El campo solo puede contener letras",{excludeEmptyString:!0}),departamento:a().required("El campo es requerido"),provincia:a().required("El campo es requerido"),distrito:a().required("El campo es requerido"),agency:a().required("Seleccione una oficina")})}}},g=i=>(G("data-v-5405d114"),i=i(),R(),i),X={class:"container"},j={class:"product_wizard_step_2__title"},Q=g(()=>r("h5",null," Antes de continuar, necesitamos algunos datos, por favor ingr\xE9salos ",-1)),W={class:"product_wizard_step_2__inputs"},Y={key:0,class:"product_wizard_step_2__inputs-item"},ee={key:1,class:"product_wizard_step_2__inputs-item"},te={key:2,class:"product_wizard_step_2__inputs-item"},se=g(()=>r("div",{class:"product_wizard_step_2__result"},[r("p",null," Selecciona el lugar donde vives para que selecciones la oficina mas cerca a t\xED: ")],-1)),ae={class:"product_wizard_step_2__selects"},re={class:"product_wizard_step_2__selects-item"},oe=g(()=>r("label",null,"Departamento",-1)),ie=["value"],ne={class:"product_wizard_step_2__selects-item"},de=g(()=>r("label",null,"Provincia",-1)),le=["value"],ue={class:"product_wizard_step_2__selects-item"},ce=g(()=>r("label",null,"Distrito",-1)),me=["value"],pe={class:"product_wizard_step_2__result"},_e={key:0,class:"product_wizard_step_2__result"},he=["value"],ge={type:"submit",class:"button"};function ve(i,t,v,fe,s,l){const z=p("TimerView"),u=p("Field"),c=p("ErrorMessage"),V=p("BaseLoading"),$=p("Form");return n(),d(h,null,[o(z),o($,{onSubmit:l.saveData,"validation-schema":l.schema,class:"product_wizard product_wizard_step_2"},{default:_(()=>[r("div",X,[r("div",j,[r("h4",null,"\xA1Hola "+m(l.clientName)+"!",1),Q]),r("div",W,[l.isClient?y("",!0):(n(),d("div",Y,[o(u,{name:"name",class:"input-text",placeholder:"Nombres",modelValue:s.data.name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.data.name=e),onKeypress:t[1]||(t[1]=e=>l.onlyLetters(e))},null,8,["modelValue"]),o(c,{name:"name",class:"message-error"})])),l.isClient?y("",!0):(n(),d("div",ee,[o(u,{name:"last_name",class:"input-text",placeholder:"Apellidos",modelValue:s.data.last_name,"onUpdate:modelValue":t[2]||(t[2]=e=>s.data.last_name=e),onKeypress:t[3]||(t[3]=e=>l.onlyLetters(e))},null,8,["modelValue"]),o(c,{name:"last_name",class:"message-error"})])),l.isDPF?(n(),d("div",te,[o(u,{type:"tel",name:"amount",class:"input-text",placeholder:"Monto a solicitar",autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",equal:"false",modelValue:s.data.amountRequested,"onUpdate:modelValue":t[4]||(t[4]=e=>s.data.amountRequested=e),onKeypress:t[5]||(t[5]=e=>l.onlyNumbers(e))},null,8,["modelValue"]),o(c,{name:"amount",class:"message-error"})])):y("",!0)]),se,r("div",ae,[r("div",re,[oe,o(u,{as:"select",name:"departamento",class:"input-select",modelValue:s.data.departamento,"onUpdate:modelValue":t[6]||(t[6]=e=>s.data.departamento=e),onChange:t[7]||(t[7]=e=>l.getDepartamento())},{default:_(()=>[(n(!0),d(h,null,E(s.departamentos,e=>(n(),d("option",{value:e.id,key:e},m(e.name),9,ie))),128))]),_:1},8,["modelValue"]),o(c,{name:"departamento",class:"message-error"})]),r("div",ne,[de,o(u,{as:"select",name:"provincia",class:"input-select",modelValue:s.data.provincia,"onUpdate:modelValue":t[8]||(t[8]=e=>s.data.provincia=e),onChange:t[9]||(t[9]=e=>l.getProvincia())},{default:_(()=>[(n(!0),d(h,null,E(s.provincias_select,e=>(n(),d("option",{value:e.id,key:e},m(e.name),9,le))),128))]),_:1},8,["modelValue"]),o(c,{name:"provincia",class:"message-error"})]),r("div",ue,[ce,o(u,{as:"select",name:"distrito",class:"input-select",modelValue:s.data.distrito,"onUpdate:modelValue":t[10]||(t[10]=e=>s.data.distrito=e),onChange:t[11]||(t[11]=e=>l.findOffices())},{default:_(()=>[(n(!0),d(h,null,E(s.distritos_select,e=>(n(),d("option",{value:e.id,key:e},m(e.name),9,me))),128))]),_:1},8,["modelValue"]),o(c,{name:"distrito",class:"message-error"})])]),S(r("div",pe,[o(V)],512),[[k,s.loading]]),s.offices.length>0?(n(),d("div",_e,[r("ul",null,[(n(!0),d(h,null,E(s.offices,(e,A)=>(n(),d("li",{key:A},[o(u,{name:"agency",type:"radio",value:!1,modelValue:s.data.agency,"onUpdate:modelValue":t[12]||(t[12]=q=>s.data.agency=q)},{default:_(({field:q})=>[r("label",null,[r("input",Z({type:"radio",name:"terms"},q,{value:e.code}),null,16,he),H(" "+m(e.name)+" ",1),r("span",null,m(e.address),1)])]),_:2},1032,["modelValue"])]))),128))]),o(c,{name:"agency",class:"message-error"}),S(o(V,null,null,512),[[k,s.loading]]),S(r("button",ge," Solicitar ",512),[[k,!s.loading]])])):y("",!0)])]),_:1},8,["onSubmit","validation-schema"])],64)}var ke=U(J,[["render",ve],["__scopeId","data-v-5405d114"]]);export{ke as default};
